DKSF 70.4.2.A-1
DKSF 70.4.2.E-1
DKSF 71.4.2.A-1
DKSF 71.4.2.E-1
22.01.2015

- багфикс дефицита ресурсов для пингеров

DKSF 70.4.2.A-1
DKSF 70.4.2.E-1
DKSF 71.4.2.A-1
DKSF 71.4.2.E-1
29.12.2014

- нотификация для IO теперь работает также для IO выходов
- багфикс DNS, из-за которого в версии 7x.4.1 отказал полностью sendmail
- багфикс сохранения доплнительных адресатов e-mail cc:
- багфикс кнопок тестирования SNMP Setter-а на странице логики, не работали под IE
- багфикс страницы обновления прошивки, в версии 4.1 не давал залить предыдущую прошивку;
  теперь предупреждает о нежелательности даунгрейда, но не мешает залить если надо
- мелкие улучшения вёрстки веб-интерфейса


DKSF 70.4.1.A-1
DKSF 70.4.1.E-1
DKSF 71.4.1.A-1
DKSF 71.4.1.E-1
24.12.2014

- добавлены стандартные модули ping-сторожа и расписания c выходом на слаботочное реле
- реализована нотификация о срабатывании реле (такая же, как для IO линий; ранее были только сообщения в журнал)
- реализовано до 4 адресатов (CC:) для e-mail нотификации
- реализованы задаваемые пользователем подписи к состояниям IO линии, отображаются 
  в веб-интерфейсе, журнале, e-mail сообщениях
- текущий уровень на IO линии в режиме выхода читается через SNMP переменную npIoLevelIn, CGI и SMS команды,
  доступен для модуля логики
- реализована посылка произвольного SMS сообщения через CGI и SNMP интерфейсы
- реализована поддержка CORS заголовков и команд в http сервере, что даёт возможность задействовать
  CGI API прибора через XMLHttpRequest, без дополнительных ухищрений, предназначенных для обхода
  Same Origin Policy веб-браузеров
- реализовано полное отключение всех уведомлений одним чекбоксом на веб-странице настроек, с предупреждением 
  о действующем запрете уведомлений в навигационном заголовке веб-интерфейса
- восстановлен пингер в модуле SMS
- восстановлены уведомления от Сторожа через SMS
- предупреждение о нежелательности даунгрейда прошивки
- многочисленные внутренние доработки кода, незаметные для пользователя
- поддержка модели без GSM модуля и RS232/RS485

-----------------------------------------

JavaScript код для отправки SMS сообщения:

var r = new XMLHttpRequest();
r.open('POST', 'http://192.168.0.100/sendsms.cgi', true, 'visor', 'ping');
r.withCredentials = true;
r.send('[+79130000000] Houston, we have a problem!');

Сначала номер адресата в квадратных скобках, затем через пробел текст сообщения.
В тексте SMS допускаются только латинские буквы.
Можно отправить SMS на несколько (до 4) номеров, указав их в квадратных скобках через запятую, без пробелов.
Если квадратные скобки с номером адресата в начале сообщения отсутствуют, сообщение отправляется адресатам, указанным на веб-странице настройки SMS.

Если формат данных правильный, качестве результата возвращается JS код:

sendsms_result('ok');

Результат посылки сообщения не влияет на возвращаемый CGI ответ!
CGI только иницирует посылку сообщения!

-----------------------------------------

Можно отправлять SMS через SNMP.
Для этого номер адресата и текст SMS в формате, продемонстрированном выше,
записывается в переменную npGsmSendSms (см. MIB файл).

-----------------------------------------

DKSF 70.3.5.A-1
DKSF 70.3.5.E-1
28.11.2014

- устранена вероятность непосылки трапов и SMS сообщений, независимо от настроек уведомлений
- улучшена надёжность посылки e-mail; реализована LOGIN аутентификация в дополнение к PLAIN
- багфикс алгоритма работы с IO линиями, теперь нормально работает счёт импульсов, корректно 
  посылается SMS, корректно отрабатывается смена напрвления линии
- добавлена страница определения уникального номера 1-Wire датчика
- багфикс DNS, устранена вероятность сброса адреса при использовании "числового" ip, 
  нормально работает обновление записи в DNS кэше по истечении срока жизни записи
- доработано JSON-P API, запрос к датчику влажности возвращает relhum_resilt(), багфикс relay.cgi
- в MIB файле изменены на корректные определения индексов таблиц реле и IO линий, 
  добавлено значение для переключения реле, 
  изменены значения статуса датчика влажности на корректные
- изменена настройка драйвера 1-Wire шины для лучшей надёжности чтения датчиков
- изменена настройка TCP для улучшения надёжности при обновлении прошивки.
  Ранее приходилось чаще повторять заливку из-за сбоев обновления.
  Сбои не имели фатальных последствий и восстанавливались перезаливкой прошивки.
- косметичекие правки в HTML ресурсах, улучшение английской версии веб-интерфейса

DKSF 70.3.4.A-1
DKSF 70.3.4.E-1
14.08.2014

- багфикс sendmail
- доработка англ. версии (отчёт)
- uptime на гл.странице
- MTU сокращено до 1100 байт
- CS NORM в логике (багфикс js кода в 70.3.4, 70.3.3 имеет проблему)
- обновление прошивок из IE9+
- новый JSON-P http API (70.3.3, в 70.3.4 добавлен IR модуль)

DKSF 70.3.2.B-1
11.06.2014

- поддержка гигростата в логике
- действие "переключение" в логике
- подключен токовый датчик (дыма)

- может не работать UART!


DKSF 70.3.1.B-1
10.06.2014

- поддержка платы DKST 70.1.2
- DNS клиент
- новая система уведомлений и отчётов
- sendmail (SMTP клиент)
- улучшение вёрстки веб-интерфейса
- многочисленные обновления и изменения кода

DKSF 70.2.7.A-1
20.03.2014

- диалог-предупреждение о возможном переключении реле и IO при рестарте на странице index.html

DKSF 70.2.6.A-1
19.03.2014

- восстановлено поле e-mail для сервися форвардинга уведомлений на веб-странице настроек
- кнопка рестарта GSM модема, последняя ошибка, чекбокс дампа обмена с модемом в лог
- ветка MIB  ...ifTable.ifEntry.ifDescr.1 


DKSF 70.2.5.A-1
11.03.2014

- багфикс ow_init.cgi
- багфикс температуры датчика влажности (дробная часть считывалась неправильно)
- улучшение работы однопроводных датчиков

Для считывания температуры датчика влажности надо его MAC забить в канал температуры (начиная с 70.2.1).
Однако, эта функция работает только если датчик влажности подключен (МАС забит) на странице влажности.


DKSF 70.2.4.A-1
5.03.2014

- багфикс настроек трапов в веб-интефейсе
- LED питания
- служебный CGI для прошивки 1W датчиков на производстве

DKSF 70.2.3.A-1
4.02.2013

- багфикс зависания прошивки

DKSF 70.2.2.A-1
3.02.2014

- **** КЛИЕНТАМ НЕ ОТДАВАТЬ, КРИТИЧЕСКИЙ БАГ ******
- багфикс сетевого стека (потери пакетов)
- багфикс установки режима управления реле через СМС
- мелкие исправления

СМС команды управления реле:
Netping P1+ <пароль>    вкл вручную
Netping P1- <пароль>    выкл вручную
Netping P1L <пароль>    управление от логики

значения npRelayMode.1 :
0   выкл вручную
1   вкл вручную
4   управление от логики

DKSF 70.2.1.A-1
30.01.2014

- поддержан 1W датчик влажности DKST910.1-01
  процедура подключения такая же, как для датчиков температуры
- показания температуры с датчика влажности выводятся в произвольный канал датчиков температуры
  (при настройке для канала температуры уникального номера датчика влажности)
- можно считывать температуру датчика влажности с дробным значением градусов 
  (на вебстранице и через новую MIB переменную - значение T * 100)
- багфиксы в MIB дереве, новые ветки
- багфикс сохранения настроек реле
- багфикс пингера в модуле СМС
- новые СМС команды H? и Tn?

- **ВНИМАНИЕ** СМС команда посылки ИК команды через IRC-TRv2 теперь использует букву K вместо прежней T

Новые СМС команды:

NetPing H? <пароль-коммюнити> [идентификатор запроса]
запрос влажности

NetPing Tn? <пароль-коммюнити> [идентификатор запроса]
запрос температуры, n = 1 .. 8 номер датчика температуры

NetPing Kn <пароль-коммюнити> [идентификатор запроса]
послать ИК команду n, n = 1 .. 16 номер ИК команды

Команды H?, Tn? выдают также статус датчика - отказ и положение 
значения относительно заданного диапазона нормы 



DKSF 70.1.4.A-1
9.10.2013

- установка SN через вебинтерфейс
- модифицированы sw i2c, delay


DKSF 70.1.2.A-1
30.07.2013

- начальная версия
- не задействован порт RS-232, требуется доработка железа
- контроль Enet линка отключен, требуется доработка железа
