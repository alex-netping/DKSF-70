/*@{
defgroup LED
*\autor 
*version 1.0
*\date 17.08.2007
*
*
*/

#include "platform_setup.h"
#ifndef  LED_H
#define  LED_H
///Версия модуля
#define  LED_VER	1
///Сборка модуля
#define  LED_BUILD	0
//------------- Проверка зависимостей
#ifndef	LED_ON
 #error "LED_ON: LED_ON not defined!!!"
#endif
#ifndef	LED_OFF
 #error "LED_OFF: LED_OFF not defined!!!"
#endif
//------------- Определение вызовов из зависимых модулей ---------------------

//------------- Описание структуры модуля ------------------------------------
///Кол-во процедур инициализации
#define LED_INITS	1
///Кол-во процедур исполняемых в главном цикле
#ifdef LED_NO_INTR
 #define LED_EXECS	1
#else 
 #define LED_EXECS	0
#endif
///Кол-во процедур исполняемых в таймере
#define LED_TIMERS	1
///Структура описания модуля
extern const struct module_rec led_struct;  


//---------------- Раздел, где будут определяться константы модуля -------------------------

//---------------- Раздел, где будут определяться структуры модуля -------------------------

//---------------- Раздел, где будут определяться глобальные переменные модуля -------------

///Флаг таймера
extern uword led_timer_flag;

//---------------- Раздел, где будут определяться функции модуля ---------------------------

/*! Процедура начальной нициализации модуля
 Процедура включает светодиод
Прим. Процедуру необходимо разместить в структуру описания модуля
Прим. Управление светодиодом осуществляется с помощью внешних процедур LED_ON,LED_OFF 
*/
extern void led_init(void);

/*! Процедура обработчик таймера
Процедура вызывается в таймерном обработчике раз в 10мс и устанавливает led_timer_flag в 1
Если не определен флаг LED_NO_INTR необходимо в обработчике вызывать процедуру led_exec() (см ниже)
*/
extern void led_timer(void);

/*! Процедура обработчика мигания светодиода
Процедура формирует заданное (см ниже) кол-во, импульсов на светодиоде
с заданными временными характеристиками
Процедура контролирует таймер по флагу led_timer_flag.
Если определен флаг LED_NO_INTR то данную процедуру необходимо 
определить в структуре описания модуля.
*/
extern void led_exec(void);

/*! Процедура инициирует генерацию импульсов на светодиоде
\param t_low -время пока светодиод выключен
\param t_hi - время пока светодиод включен
\param num - кол-во импульсов которые необходимо сгенерить, если параметр равен 0
             то генерить импульсы бесконечно.
*/
//extern void led_generation(uword t_low,uword t_hi,uword num);
extern void led_generation(unsigned int t_low,unsigned int t_hi,uword num);

/*! Процедура останавливает генерацию импульсов на светодиоде
 после чего влючает его постояно
*/
extern void led_stop_generation(void);

#endif
//}@
